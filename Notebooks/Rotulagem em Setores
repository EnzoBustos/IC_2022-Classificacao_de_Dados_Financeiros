{"cells":[{"cell_type":"markdown","metadata":{"id":"GiWXf4bUWHUa"},"source":["# Instalando DependÃªncias"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19285,"status":"ok","timestamp":1660161467126,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"},"user_tz":180},"id":"lueuvjDqWE8R","outputId":"a9d22b85-8bc0-490e-b247-7978f81745da"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: transformers in /usr/local/lib/python3.7/dist-packages (4.21.1)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: tokenizers!=0.11.3,<0.13,>=0.11.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.12.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (5.4.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.7.1)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (0.8.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2022.6.2)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.1.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.1)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.6.15)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: sentencepiece in /usr/local/lib/python3.7/dist-packages (0.1.97)\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: bertopic in /usr/local/lib/python3.7/dist-packages (0.11.0)\n","Requirement already satisfied: umap-learn>=0.5.0 in /usr/local/lib/python3.7/dist-packages (from bertopic) (0.5.3)\n","Requirement already satisfied: plotly>=4.7.0 in /usr/local/lib/python3.7/dist-packages (from bertopic) (5.5.0)\n","Requirement already satisfied: hdbscan>=0.8.28 in /usr/local/lib/python3.7/dist-packages (from bertopic) (0.8.28)\n","Requirement already satisfied: pyyaml<6.0 in /usr/local/lib/python3.7/dist-packages (from bertopic) (5.4.1)\n","Requirement already satisfied: tqdm>=4.41.1 in /usr/local/lib/python3.7/dist-packages (from bertopic) (4.64.0)\n","Requirement already satisfied: sentence-transformers>=0.4.1 in /usr/local/lib/python3.7/dist-packages (from bertopic) (2.2.2)\n","Requirement already satisfied: scikit-learn>=0.22.2.post1 in /usr/local/lib/python3.7/dist-packages (from bertopic) (1.0.2)\n","Requirement already satisfied: pandas>=1.1.5 in /usr/local/lib/python3.7/dist-packages (from bertopic) (1.3.5)\n","Requirement already satisfied: numpy>=1.20.0 in /usr/local/lib/python3.7/dist-packages (from bertopic) (1.21.6)\n","Requirement already satisfied: scipy>=1.0 in /usr/local/lib/python3.7/dist-packages (from hdbscan>=0.8.28->bertopic) (1.7.3)\n","Requirement already satisfied: cython>=0.27 in /usr/local/lib/python3.7/dist-packages (from hdbscan>=0.8.28->bertopic) (0.29.32)\n","Requirement already satisfied: joblib>=1.0 in /usr/local/lib/python3.7/dist-packages (from hdbscan>=0.8.28->bertopic) (1.1.0)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=1.1.5->bertopic) (2022.1)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=1.1.5->bertopic) (2.8.2)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.7/dist-packages (from plotly>=4.7.0->bertopic) (8.0.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from plotly>=4.7.0->bertopic) (1.15.0)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.22.2.post1->bertopic) (3.1.0)\n","Requirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (from sentence-transformers>=0.4.1->bertopic) (3.7)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.7/dist-packages (from sentence-transformers>=0.4.1->bertopic) (1.12.0+cu113)\n","Requirement already satisfied: transformers<5.0.0,>=4.6.0 in /usr/local/lib/python3.7/dist-packages (from sentence-transformers>=0.4.1->bertopic) (4.21.1)\n","Requirement already satisfied: torchvision in /usr/local/lib/python3.7/dist-packages (from sentence-transformers>=0.4.1->bertopic) (0.13.0+cu113)\n","Requirement already satisfied: sentencepiece in /usr/local/lib/python3.7/dist-packages (from sentence-transformers>=0.4.1->bertopic) (0.1.97)\n","Requirement already satisfied: huggingface-hub>=0.4.0 in /usr/local/lib/python3.7/dist-packages (from sentence-transformers>=0.4.1->bertopic) (0.8.1)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (4.12.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (4.1.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (3.7.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (2.23.0)\n","Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (21.3)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.9->huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (3.0.9)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers>=0.4.1->bertopic) (2022.6.2)\n","Requirement already satisfied: tokenizers!=0.11.3,<0.13,>=0.11.1 in /usr/local/lib/python3.7/dist-packages (from transformers<5.0.0,>=4.6.0->sentence-transformers>=0.4.1->bertopic) (0.12.1)\n","Requirement already satisfied: pynndescent>=0.5 in /usr/local/lib/python3.7/dist-packages (from umap-learn>=0.5.0->bertopic) (0.5.7)\n","Requirement already satisfied: numba>=0.49 in /usr/local/lib/python3.7/dist-packages (from umap-learn>=0.5.0->bertopic) (0.56.0)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from numba>=0.49->umap-learn>=0.5.0->bertopic) (57.4.0)\n","Requirement already satisfied: llvmlite<0.40,>=0.39.0dev0 in /usr/local/lib/python3.7/dist-packages (from numba>=0.49->umap-learn>=0.5.0->bertopic) (0.39.0)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (3.8.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from nltk->sentence-transformers>=0.4.1->bertopic) (7.1.2)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (2022.6.15)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->huggingface-hub>=0.4.0->sentence-transformers>=0.4.1->bertopic) (3.0.4)\n","Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.7/dist-packages (from torchvision->sentence-transformers>=0.4.1->bertopic) (7.1.2)\n"]}],"source":["!pip install transformers\n","!pip install sentencepiece\n","!pip install bertopic"]},{"cell_type":"markdown","metadata":{"id":"jkpDjZ1eWK6H"},"source":["# Carregando dados"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"f2UTMZ6Y_gl2","colab":{"base_uri":"https://localhost:8080/","height":223},"executionInfo":{"status":"ok","timestamp":1660161486151,"user_tz":180,"elapsed":19038,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"9ed6539e-0156-41b5-82cb-ee64a4c9113c"},"outputs":[{"output_type":"stream","name":"stdout","text":["1526914\n"]},{"output_type":"execute_result","data":{"text/plain":["                        date  \\\n","0  2011-12-06 00:47:32+00:00   \n","1  2020-11-10 15:20:00+00:00   \n","2  2012-08-03 12:57:11+00:00   \n","3  2012-08-24 22:01:37+00:00   \n","4  2019-07-27 09:00:00+00:00   \n","\n","                                                 url  \\\n","0  https://valor.globo.com/noticia/2011/12/06/rai...   \n","1  https://exame.com/economia/guedes-promete-quat...   \n","2  https://valor.globo.com/eu-e/noticia/2012/08/0...   \n","3  https://valor.globo.com/noticia/2012/08/24/joa...   \n","4  https://exame.com/brasil/o-que-se-sabe-sobre-a...   \n","\n","                                               texts  is_title  \n","0  Raia Drogasil substitui conselho fiscal por co...      True  \n","1  Mais cedo, em outro evento, Guedes afirmou se ...     False  \n","2  Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...     False  \n","3  A pesquisa foi realizada entre os dias 20 e 22...     False  \n","4  Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...     False  "],"text/html":["\n","  <div id=\"df-9fd427b3-b96e-4522-bfe0-adc51869a472\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>date</th>\n","      <th>url</th>\n","      <th>texts</th>\n","      <th>is_title</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2011-12-06 00:47:32+00:00</td>\n","      <td>https://valor.globo.com/noticia/2011/12/06/rai...</td>\n","      <td>Raia Drogasil substitui conselho fiscal por co...</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2020-11-10 15:20:00+00:00</td>\n","      <td>https://exame.com/economia/guedes-promete-quat...</td>\n","      <td>Mais cedo, em outro evento, Guedes afirmou se ...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2012-08-03 12:57:11+00:00</td>\n","      <td>https://valor.globo.com/eu-e/noticia/2012/08/0...</td>\n","      <td>Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2012-08-24 22:01:37+00:00</td>\n","      <td>https://valor.globo.com/noticia/2012/08/24/joa...</td>\n","      <td>A pesquisa foi realizada entre os dias 20 e 22...</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2019-07-27 09:00:00+00:00</td>\n","      <td>https://exame.com/brasil/o-que-se-sabe-sobre-a...</td>\n","      <td>Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...</td>\n","      <td>False</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9fd427b3-b96e-4522-bfe0-adc51869a472')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9fd427b3-b96e-4522-bfe0-adc51869a472 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9fd427b3-b96e-4522-bfe0-adc51869a472');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":2}],"source":["import pandas as pd\n","import numpy as np\n","from tqdm.notebook import tqdm\n","tqdm.pandas()\n","\n","df = pd.read_csv(\"/content/drive/MyDrive/IniciacÌ§aÌo CientiÌfica/IC 2022/Data/all_finantial_sentences.csv\")\n","print(len(df))\n","df.head()"]},{"cell_type":"markdown","source":["# Brute force"],"metadata":{"id":"M6OnyjRXVbo3"}},{"cell_type":"code","source":["import re\n","\n","theme_brute = []\n","\n","def classify_theme_by_brute(text):\n","    if re.search(r\"/Biomm |Nortcquimica|Ourofino|Alliar|Dasa|Fleury|Hapvida|Ihpardini|Kora Saude|Mater Dei|Odontoprev|Oncoclinicas|Qualicorp |Rede D Or|Baumer|Lifemed|Blau|D1000vfarma|Dimed|Hypera|Pague Menos|Profarma|Raiadrogasil|Viveo|Drogaraia|Drogasil|Raia/gm\", text):\n","        theme_brute.append(\"SaÃºde\")\n","    elif re.search(r\"/Aura 360|Bradespar|Cba|Csnmineracao|Litel|Litela|Mmx Miner|Vale|Ferbasa|Gerdau|Gerdau Met|Sid Nacional|Usiminas|Mangels Indl|Panatlantica|Tekno|Paranapanema|Braskem|Dexxos Par|Fer Heringer|Nutriplant|Vittia|Cristal|Unipar|Dexco|Eucatex|Klabin|Melhor Sp|Suzano Hold|Suzano|Irani|Metal Iguacu|Sansuy|Eternit|Haga|Portobello|Azevedo|Sondotecnica|Tecnosolo|Embraer|Fras-le|Marcopolo|Randon Part|Recrusul|Riosulense|Tupy|Wetzel S\\/a|Schulz|Weg|Aco Altona|Aeris|Armac|Bardella|Inepar|Kepler Weber|Metalfrio|Mills|Nordon Met|Pratica|Romi|Metisa|Stara|Taurus Armas|Azul|Gol|All Norte|All Paulista|Fer C Atlant|Mrs Logist|Rumo|Hidrovias|Log-in|Trevisa|Jsl|Tegma|Autoban|Ccr Sa|Conc Raposo|Conc Rio Ter|Ecopistas|Ecorodovias|Ecovias|Rod Colinas|Rod Tiete|Rt Bandeiras|Triangulosol|Triunfo Part|Viaoeste|Gruairport|Hmobi S.a|Invepar|Porto Vm|Salus Infra|Santos Brp|Wilson Sons|Atmasa|Bbmlogistica|Dtcom-direct|Estapar|Flex|Gps|Priner|Sequoia Log|Valid|Embpar|Minasmaquina|Rodobens|Wlm Ind Com/gm\", text):\n","        theme_brute.append(\"Bens Industriais\")\n","    elif re.search(r\"/Algar Telec|Brisanet|Desktop|Oi|Telebras|Telef Brasil|Tim|Unifique|Cinesystem|Eletromidia|Vivo|Claro|Tim/gm\", text):\n","        theme_brute.append(\"ComunicaÃ§Ãµes\")\n","    elif re.search(r\"/Alphaville|Const A Lind|Cr2Cury|Cyrela Realt|DirecionalEvenEztecGafisaHelborInter SaJhsf PartJoao FortesKallas|Lavvi|Melnick|Mitre Realty|Moura Dubeux|MrvPdg RealtPlanoeplano|Rni|Rossi ResidTecnisaTegra Incorp|Tenda|TrisulViverCedroCoteminasDohlerInd Cataguas|KarstenPettenatiSantanenseSpringsTekaTex RenauxTrack Field|AlpargatasCambuciGrendeneVulcabrasMundialTechnosVivara|WhirlpoolUnicasa|Hercules|Iochp-maxion|Metal Leve|Plascar Part|Hoteis Othon|Bk Brasil|Imc|Bic MonarkEstrelaSpturisTime For Fun|Cvc Brasil|Smart Fit|Anima|BahemaCogna On|Cruzeiro Edu|Ser Educa|Yduqs Part|LocalizaLocamerica|Maestroloc|Movida|UnidasVamos|Dotz Sa|Arezzo CoCea Modas|GrazziotinGrupo Soma|GuararapesLe Lis Blanc|Lojas Marisa|Lojas Renner|Allied|Magaz LuizaVia|Americanas|Espacolaser|Grupo Sbf|Le Biscuit|Petz|Quero-quero|Saraiva Livr|Saraiva|Burguer King/gm\", text):\n","        theme_brute.append(\"Consumo CÃ­clico\")\n","    elif re.search(r\"/3tentos|Agribrasil|Agrogalaxy|Aliperti|Boa Safra|Brasilagro|Pomifrutas|Raizen|Slc Agricola|Terrasantapa|Jallesmachad|Raizen Energ|Sao Martinho|Carnes E Derivados|Brf Sa|Excelsior|Jbs|Marfrig|Minerva|Minupar|Camil|J.macedo|Josapar|M.diasbranco|Oderich|Ambev|Grupo Natura|Bombril|Assai|Carrefour Br|Grupo Mateus|P.acucar-cbd|Natura|PÃ£o de AÃ§Ãºcar|Raizen|JBS|Carrefour/gm\", text):\n","        theme_brute.append(\"Consumo nÃ£o CÃ­clico\")\n","    elif re.search(r\"/Abc Brasil|Alfa Holding|Alfa Invest|Amazonia|Banco Bmg|Banco Inter|Banco Pan|Banese|Banestes|Banpara|Banrisul|Br Partners|Bradesco|Brasil|Brb Banco|Btgp Banco|Itausa|Itauunibanco|Merc Brasil|Merc Invest|Modalmais|Nord Brasil|Nu-nubank|Parana|Pine|Santander Br|Alfa Financ|Finansinos|Merc Financ|Bradesco Lsg|Dibens Lsg|Brazil Realt|Brazilian Sc|Brpr 56 Sec|Cibrasec|Eco Sec Agro|Gaia Agro|Gaia Securit|Octante Sec|Pdg Securit|Polo Cap Sec|Rbcapitalres|Truesec|Vertciasec|Wtorre Pic|Bndespar|Brazilian Fr|G2d Invest|Gp Invest|Ppla|B3|Boa Vista|Cielo|Clearsale|Csu Cardsyst|Getnet Br|Stone Co|Xp Inc|Alfa Consorc|Bbseguridade|Caixa Seguri|Porto Seguro|Seg Al Bahia|Sul America|Irbbrasil Re|Alper|Wiz|Alianscsonae|Br Malls Par|Br Propert|Cor Ribeiro|Cyre Com-ccp|Generalshopp|Habitasul|Hbr Realty|Igb|Iguatemi|Log Com Prop|Menezes Cort|Multiplan|Sao Carlos|Syn Prop Tec|Lopes Brasil|Nexpe|Mont Aranha|Par Al Bahia|Simpar|Cepac - Ctba|Cepac - Mcrj|Cepac - Pmsp|Inter|Pan|Banco do Brasil|BTG|ItaÃº|Nubank|Santander|Alfa|Merc|BNDES|/gm\", text):\n","        theme_brute.append(\"Financeiro\")\n","    elif re.search(r\"/Aura 360|Bradespar|CBA|Csnmineracao|Litel|Litela|Mmx Miner|Vale|Ferbasa|Gerdau|Gerdau Met|Sid Nacional|Usiminas|Mangels Indl|Panatlantica|Tekno|Paranapanema|Braskem|Dexxos Par|Fer Heringer|Nutriplant|Vittia|Cristal|Unipar|Dexco|Eucatex|Klabin|Melhor Sp|Suzano Hold|Suzano|Irani|Metal Iguacu|Sansuy/gm\", text):\n","        theme_brute.append(\"Materiais BÃ¡sicos\")\n","    elif re.search(r\"/524 Particip|Atompar|B Tech Eqi|Betapart |Cabinda Part|Caconde Part|Cemepe |Cims |Gama Part |Invest Bemge|Polpar |Prompt Part |Sudeste|Sul 116 Part|Ybyra/gm\", text):\n","        theme_brute.append(\"Outros\")\n","    elif re.search(r\"/3r Petroleum|Cosan|Dommo|Enauta Part|Pet Manguinh|Petrobras|Petrorecsa|Petrorio|Ultrapar|Vibra|Lupatech|Oceanpact|Osx Brasil/gm\", text):\n","        theme_brute.append(\"PetrÃ³leo, GÃ¡s e BiocombustÃ­veis\")\n","    elif re.search(r\"/Intelbras|Multilaser|Positivo Tec|Bemobi Tech|Brq|Enjoei|Getninjas|Infracomm|Locaweb|Meliuz|Mobly|Neogrid|Padtec|Quality Soft|Sinqia|Tc|Totvs |Wdc Networks|Westwing/gm\", text):\n","        theme_brute.append(\"Tecnologia da InformaÃ§Ã£o\")\n","    elif re.search(r\"/Aes Brasil|Aes Sul|Aesoperacoes|Afluente T|Alupar|Ampla Energ|Auren|Cachoeira|Ceb|Ceee-d|Ceee-t|Celesc|Celgpar|Celpe|Cemig|Cemig Dist|Cemig Gt|Coelba|Coelce|Comerc Par|Copel|Cosern|Cpfl Energia|Cpfl Geracao|Cpfl Piratin|Cpfl Renovav|Ebe|Elektro|Eletrobras|Eletropar|Emae|Energias Br|Energisa|Energisa Mt|Enersul|Eneva|Engie Brasil|Eqtl Para|Eqtlmaranhao|Equatorial|Escelsa|Fgenergia|Ger Paranap|Itapebi|Light|Light S/a|Neoenergia|Omegaenergia|Paul F Luz|Proman|Rede Energia|Renova|Statkraft|Sto Antonio|Taesa|Term. Pe Iii|Termope|Tran Paulist|Uptick|Ambipar|Casan|Copasa|Igua Sa|Orizon|Sabesp|Sanepar|Sanesalto|Ceg|Comgas|Compass|AES|Cemig|CEMIG/gm\", text):\n","        theme_brute.append(\"Utilidade PÃºblica\")\n","    else:\n","        theme_brute.append(np.nan)\n","\n","df[\"texts\"].apply(classify_theme_by_brute)\n","df[\"theme\"] = theme_brute"],"metadata":{"id":"WfE5q6S3SUq7","executionInfo":{"status":"ok","timestamp":1660161551873,"user_tz":180,"elapsed":65739,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["df.loc[df[\"theme\"].isnull()]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":468},"id":"1-6jLbtQWbPW","executionInfo":{"status":"ok","timestamp":1660161552403,"user_tz":180,"elapsed":544,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"a979718c-1d27-4938-aca1-a3e25f291217"},"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                              date  \\\n","1        2020-11-10 15:20:00+00:00   \n","2        2012-08-03 12:57:11+00:00   \n","3        2012-08-24 22:01:37+00:00   \n","4        2019-07-27 09:00:00+00:00   \n","5        2020-03-30 15:33:00+00:00   \n","...                            ...   \n","1526907  2020-03-09 11:47:17+00:00   \n","1526908  2020-08-31 13:01:00+00:00   \n","1526910  2014-12-02 15:16:00+00:00   \n","1526911  2021-02-12 16:28:00+00:00   \n","1526913  2020-03-23 15:31:00+00:00   \n","\n","                                                       url  \\\n","1        https://exame.com/economia/guedes-promete-quat...   \n","2        https://valor.globo.com/eu-e/noticia/2012/08/0...   \n","3        https://valor.globo.com/noticia/2012/08/24/joa...   \n","4        https://exame.com/brasil/o-que-se-sabe-sobre-a...   \n","5        https://exame.com/pme/vamos-salvar-os-empregos...   \n","...                                                    ...   \n","1526907  https://www.infomoney.com.br/onde-investir/com...   \n","1526908  https://exame.com/casual/botin-restaurante-mai...   \n","1526910  https://www.infomoney.com.br/onde-investir/ban...   \n","1526911  https://exame.com/mundo/mario-draghi-aceita-ca...   \n","1526913  https://exame.com/estilo-de-vida/grifes-de-lux...   \n","\n","                                                     texts  is_title theme  \n","1        Mais cedo, em outro evento, Guedes afirmou se ...     False   NaN  \n","2        Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...     False   NaN  \n","3        A pesquisa foi realizada entre os dias 20 e 22...     False   NaN  \n","4        Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...     False   NaN  \n","5        JosÃ© Carlos Semenzato estÃ¡ acostumado com desa...     False   NaN  \n","...                                                    ...       ...   ...  \n","1526907  A recomendaÃ§Ã£o da casa Ã© que o investimento ne...     False   NaN  \n","1526908  Acostumado a receber milhares de turistas, o R...     False   NaN  \n","1526910  Banco Fator aposta em aÃ§Ãµes de infraestrutura ...      True   NaN  \n","1526911  No Ãºltimo minuto, o antissistema Movimento 5 E...     False   NaN  \n","1526913  A Bulgari, marca centenÃ¡ria de joias fundada e...     False   NaN  \n","\n","[1231659 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-fcf2fa84-c285-4ae7-97cd-d01292c6221c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>date</th>\n","      <th>url</th>\n","      <th>texts</th>\n","      <th>is_title</th>\n","      <th>theme</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>2020-11-10 15:20:00+00:00</td>\n","      <td>https://exame.com/economia/guedes-promete-quat...</td>\n","      <td>Mais cedo, em outro evento, Guedes afirmou se ...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2012-08-03 12:57:11+00:00</td>\n","      <td>https://valor.globo.com/eu-e/noticia/2012/08/0...</td>\n","      <td>Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2012-08-24 22:01:37+00:00</td>\n","      <td>https://valor.globo.com/noticia/2012/08/24/joa...</td>\n","      <td>A pesquisa foi realizada entre os dias 20 e 22...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2019-07-27 09:00:00+00:00</td>\n","      <td>https://exame.com/brasil/o-que-se-sabe-sobre-a...</td>\n","      <td>Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>2020-03-30 15:33:00+00:00</td>\n","      <td>https://exame.com/pme/vamos-salvar-os-empregos...</td>\n","      <td>JosÃ© Carlos Semenzato estÃ¡ acostumado com desa...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1526907</th>\n","      <td>2020-03-09 11:47:17+00:00</td>\n","      <td>https://www.infomoney.com.br/onde-investir/com...</td>\n","      <td>A recomendaÃ§Ã£o da casa Ã© que o investimento ne...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1526908</th>\n","      <td>2020-08-31 13:01:00+00:00</td>\n","      <td>https://exame.com/casual/botin-restaurante-mai...</td>\n","      <td>Acostumado a receber milhares de turistas, o R...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1526910</th>\n","      <td>2014-12-02 15:16:00+00:00</td>\n","      <td>https://www.infomoney.com.br/onde-investir/ban...</td>\n","      <td>Banco Fator aposta em aÃ§Ãµes de infraestrutura ...</td>\n","      <td>True</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1526911</th>\n","      <td>2021-02-12 16:28:00+00:00</td>\n","      <td>https://exame.com/mundo/mario-draghi-aceita-ca...</td>\n","      <td>No Ãºltimo minuto, o antissistema Movimento 5 E...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1526913</th>\n","      <td>2020-03-23 15:31:00+00:00</td>\n","      <td>https://exame.com/estilo-de-vida/grifes-de-lux...</td>\n","      <td>A Bulgari, marca centenÃ¡ria de joias fundada e...</td>\n","      <td>False</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1231659 rows Ã 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fcf2fa84-c285-4ae7-97cd-d01292c6221c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fcf2fa84-c285-4ae7-97cd-d01292c6221c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fcf2fa84-c285-4ae7-97cd-d01292c6221c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["df_nan = df.loc[df[\"theme\"].isnull()]\n","df_val = df.loc[~df[\"theme\"].isnull()]\n","\n","print(\"Tamanho do Dataset....: {}\".format(len(df)))\n","print(\"Tamanho dos Nulos.....: {}\".format(len(df_nan)))\n","print(\"Tamanho dos VÃ¡lidos...: {}\".format(len(df_val)))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"K1TX3fa-VAZi","executionInfo":{"status":"ok","timestamp":1660161552405,"user_tz":180,"elapsed":22,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"064d5ae9-91b8-430a-9dbb-6c58e1e490ee"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["Tamanho do Dataset....: 1526914\n","Tamanho dos Nulos.....: 1231659\n","Tamanho dos VÃ¡lidos...: 295255\n"]}]},{"cell_type":"markdown","source":["# TraduÃ§Ã£o"],"metadata":{"id":"-OhlGeMEXyZK"}},{"cell_type":"code","source":["df_val_cropped = df_val[:12500]\n","df_nan_cropped = df_nan[:12500]\n","\n","df_val_cropped[\"texts\"].to_excel(\"df_val_cropped.xlsx\", index=False)\n","df_nan_cropped[\"texts\"].to_excel(\"df_nan_cropped.xlsx\", index=False)"],"metadata":{"id":"CuvX-2MNXxjZ","executionInfo":{"status":"ok","timestamp":1660161554082,"user_tz":180,"elapsed":1684,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["texts_val_cropped_en = pd.read_excel(\"df_val_cropped_en.xlsx\")\n","texts_nan_cropped_en = pd.read_excel(\"df_nan_cropped_en.xlsx\")\n","\n","df_val_cropped.reset_index(inplace=True)\n","df_nan_cropped.reset_index(inplace=True)\n","\n","df_val_cropped[\"translated\"] = texts_val_cropped_en\n","df_nan_cropped[\"translated\"] = texts_nan_cropped_en"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lt9354t5cV4g","executionInfo":{"status":"ok","timestamp":1660161555227,"user_tz":180,"elapsed":1147,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"7082648d-d7ae-465b-889e-a0b221ab51d9"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:7: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  import sys\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:8: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  \n"]}]},{"cell_type":"code","source":["df_nan_cropped.loc[df_nan_cropped[\"translated\"].isnull()]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"id":"CzH4fiapTk1B","executionInfo":{"status":"ok","timestamp":1660161555231,"user_tz":180,"elapsed":16,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"5d703ddb-5abf-4768-ad35-afed6d64f147"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Empty DataFrame\n","Columns: [index, date, url, texts, is_title, theme, translated]\n","Index: []"],"text/html":["\n","  <div id=\"df-fe9ab75e-c510-4769-8ac0-9becf0e0d6a4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>date</th>\n","      <th>url</th>\n","      <th>texts</th>\n","      <th>is_title</th>\n","      <th>theme</th>\n","      <th>translated</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fe9ab75e-c510-4769-8ac0-9becf0e0d6a4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fe9ab75e-c510-4769-8ac0-9becf0e0d6a4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fe9ab75e-c510-4769-8ac0-9becf0e0d6a4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["df_val_cropped.loc[df_val_cropped[\"translated\"].isnull()]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"id":"PLwjAqc8VQHj","executionInfo":{"status":"ok","timestamp":1660161555235,"user_tz":180,"elapsed":18,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"1a20ca62-f020-4878-e815-fcfb2f7e6ad2"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Empty DataFrame\n","Columns: [index, date, url, texts, is_title, theme, translated]\n","Index: []"],"text/html":["\n","  <div id=\"df-6566beef-189e-4b4c-8c7a-767c8beba9d0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>date</th>\n","      <th>url</th>\n","      <th>texts</th>\n","      <th>is_title</th>\n","      <th>theme</th>\n","      <th>translated</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6566beef-189e-4b4c-8c7a-767c8beba9d0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6566beef-189e-4b4c-8c7a-767c8beba9d0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6566beef-189e-4b4c-8c7a-767c8beba9d0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":9}]},{"cell_type":"markdown","metadata":{"id":"EKr8F2n-nph4"},"source":["# Zero-Shot"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"w95FD6YqcwHu","colab":{"base_uri":"https://localhost:8080/","height":243,"referenced_widgets":["1705debae38e47ee94d771b89e9aa724","a88b631e1dff4db49f18d47ec3da5717","352c1a72fb4947c9914340eb2b7d4bd7","0f40f96cd705469096da2bdae43615a2","5c279bc190e3448398311a7c946b6577","6f875dc84d1f4a8b8be334d108844ba2","87eb226e3237459e8d8b4c48260018aa","6b4ef45b2d6a4b7d85f71ed4884d0a4d","cbe2f1b600554e1e8638b9afc951a32f","2ef3c343d7694b41b22ccb422e901ecf","f85563e2197e49328d6aa1161410721f"]},"executionInfo":{"status":"ok","timestamp":1660165004993,"user_tz":180,"elapsed":3449775,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"d44b6dcc-75b4-47c5-e203-b102a7ead70c"},"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at joeddav/xlm-roberta-large-xnli were not used when initializing XLMRobertaForSequenceClassification: ['roberta.pooler.dense.weight', 'roberta.pooler.dense.bias']\n","- This IS expected if you are initializing XLMRobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing XLMRobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/12500 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1705debae38e47ee94d771b89e9aa724"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/pipelines/base.py:1039: UserWarning: You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset\n","  UserWarning,\n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:23: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n"]}],"source":["from transformers import pipeline\n","\n","classifier = pipeline(\"zero-shot-classification\", model=\"joeddav/xlm-roberta-large-xnli\", device=0)\n","labels = [  \n","            \"Industrial Goods\",\n","            \"Communications\",\n","            \"Cyclic Consumption\",\n","            \"Non-cyclical Consumption\",\n","            \"Financial\",\n","            \"Basic Materials\",\n","            #\"Others\",\n","            \"Oil, Gas and Biofuels\",\n","            \"Health\",\n","            #\"Initial Sector\",\n","            \"Information Technology\",\n","            \"Public utility\"\n","            ]\n","\n","template = \"The economic sector of this set of words is {}.\"\n","\n","classes = [str(classifier(text, labels, hypothesis_template=template)[\"labels\"][0]) for text in tqdm(df_nan_cropped[\"translated\"].to_list())]\n","\n","df_nan_cropped[\"theme\"] = classes"]},{"cell_type":"markdown","source":["# Merge"],"metadata":{"id":"NmahpsPbGZE1"}},{"cell_type":"code","source":["pd.concat([df_nan_cropped, df_val_cropped])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":832},"id":"WhYkIxD3foZ4","executionInfo":{"status":"ok","timestamp":1660165047973,"user_tz":180,"elapsed":378,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"f0998e56-1988-4b47-e906-0373a097a0a3"},"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       index                              date  \\\n","0          1         2020-11-10 15:20:00+00:00   \n","1          2         2012-08-03 12:57:11+00:00   \n","2          3         2012-08-24 22:01:37+00:00   \n","3          4         2019-07-27 09:00:00+00:00   \n","4          5         2020-03-30 15:33:00+00:00   \n","...      ...                               ...   \n","12495  64974         2011-08-11 04:29:50+00:00   \n","12496  64979         2019-08-15 11:55:00+00:00   \n","12497  64982         2021-10-19 12:40:00+00:00   \n","12498  64987         2021-09-01 11:06:00+00:00   \n","12499  64993  2022-02-22 15:12:26.496000+00:00   \n","\n","                                                     url  \\\n","0      https://exame.com/economia/guedes-promete-quat...   \n","1      https://valor.globo.com/eu-e/noticia/2012/08/0...   \n","2      https://valor.globo.com/noticia/2012/08/24/joa...   \n","3      https://exame.com/brasil/o-que-se-sabe-sobre-a...   \n","4      https://exame.com/pme/vamos-salvar-os-empregos...   \n","...                                                  ...   \n","12495  https://valor.globo.com/politica/noticia/2011/...   \n","12496  https://exame.com/revista-exame/33-bilhoes-so-...   \n","12497  https://exame.com/negocios/conheca-o-projeto-d...   \n","12498  https://exame.com/casual/festival-de-veneza-vo...   \n","12499  https://valor.globo.com/financas/noticia/2022/...   \n","\n","                                                   texts  is_title  \\\n","0      Mais cedo, em outro evento, Guedes afirmou se ...     False   \n","1      Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...     False   \n","2      A pesquisa foi realizada entre os dias 20 e 22...     False   \n","3      Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...     False   \n","4      JosÃ© Carlos Semenzato estÃ¡ acostumado com desa...     False   \n","...                                                  ...       ...   \n","12495  \"NÃ£o gastem\", disse Mantega, segundo relato de...     False   \n","12496  Mas, enquanto a soluÃ§Ã£o para aumentar a distri...     False   \n","12497  Em 2019, a iniciativa ganhou o prÃªmio âProjeto...     False   \n","12498  Para ele, a histÃ³ria de um sujeito criado em u...     False   \n","12499  A AgÃªncia Internacional de Energia (IEA, na si...     False   \n","\n","                          theme  \\\n","0      Non-cyclical Consumption   \n","1            Cyclic Consumption   \n","2                Public utility   \n","3      Non-cyclical Consumption   \n","4      Non-cyclical Consumption   \n","...                         ...   \n","12495                Financeiro   \n","12496                Financeiro   \n","12497                Financeiro   \n","12498                Financeiro   \n","12499                Financeiro   \n","\n","                                              translated  \n","0       Earlier, at another event, Guedes said he fel...  \n","1       When talking about Dilma, the look lights up ...  \n","2       The survey was carried out between the 20th a...  \n","3       They are Gustavo Henrique Elias Santos, a for...  \n","4      JosÃ© Carlos Semenzato is used to challenges. T...  \n","...                                                  ...  \n","12495   \"Don't spend it,\" Mantega said, according to ...  \n","12496  But while the solution to increase gas distrib...  \n","12497   In 2019, the initiative won the âInnovative P...  \n","12498  For him, the story of a subject raised in a ve...  \n","12499   The International Energy Agency (IEA) lowers ...  \n","\n","[25000 rows x 7 columns]"],"text/html":["\n","  <div id=\"df-13ddb8c3-f95c-4cf3-a7ed-6b13ae43165c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>date</th>\n","      <th>url</th>\n","      <th>texts</th>\n","      <th>is_title</th>\n","      <th>theme</th>\n","      <th>translated</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2020-11-10 15:20:00+00:00</td>\n","      <td>https://exame.com/economia/guedes-promete-quat...</td>\n","      <td>Mais cedo, em outro evento, Guedes afirmou se ...</td>\n","      <td>False</td>\n","      <td>Non-cyclical Consumption</td>\n","      <td>Earlier, at another event, Guedes said he fel...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2012-08-03 12:57:11+00:00</td>\n","      <td>https://valor.globo.com/eu-e/noticia/2012/08/0...</td>\n","      <td>Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...</td>\n","      <td>False</td>\n","      <td>Cyclic Consumption</td>\n","      <td>When talking about Dilma, the look lights up ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2012-08-24 22:01:37+00:00</td>\n","      <td>https://valor.globo.com/noticia/2012/08/24/joa...</td>\n","      <td>A pesquisa foi realizada entre os dias 20 e 22...</td>\n","      <td>False</td>\n","      <td>Public utility</td>\n","      <td>The survey was carried out between the 20th a...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2019-07-27 09:00:00+00:00</td>\n","      <td>https://exame.com/brasil/o-que-se-sabe-sobre-a...</td>\n","      <td>Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...</td>\n","      <td>False</td>\n","      <td>Non-cyclical Consumption</td>\n","      <td>They are Gustavo Henrique Elias Santos, a for...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2020-03-30 15:33:00+00:00</td>\n","      <td>https://exame.com/pme/vamos-salvar-os-empregos...</td>\n","      <td>JosÃ© Carlos Semenzato estÃ¡ acostumado com desa...</td>\n","      <td>False</td>\n","      <td>Non-cyclical Consumption</td>\n","      <td>JosÃ© Carlos Semenzato is used to challenges. T...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>12495</th>\n","      <td>64974</td>\n","      <td>2011-08-11 04:29:50+00:00</td>\n","      <td>https://valor.globo.com/politica/noticia/2011/...</td>\n","      <td>\"NÃ£o gastem\", disse Mantega, segundo relato de...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>\"Don't spend it,\" Mantega said, according to ...</td>\n","    </tr>\n","    <tr>\n","      <th>12496</th>\n","      <td>64979</td>\n","      <td>2019-08-15 11:55:00+00:00</td>\n","      <td>https://exame.com/revista-exame/33-bilhoes-so-...</td>\n","      <td>Mas, enquanto a soluÃ§Ã£o para aumentar a distri...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>But while the solution to increase gas distrib...</td>\n","    </tr>\n","    <tr>\n","      <th>12497</th>\n","      <td>64982</td>\n","      <td>2021-10-19 12:40:00+00:00</td>\n","      <td>https://exame.com/negocios/conheca-o-projeto-d...</td>\n","      <td>Em 2019, a iniciativa ganhou o prÃªmio âProjeto...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>In 2019, the initiative won the âInnovative P...</td>\n","    </tr>\n","    <tr>\n","      <th>12498</th>\n","      <td>64987</td>\n","      <td>2021-09-01 11:06:00+00:00</td>\n","      <td>https://exame.com/casual/festival-de-veneza-vo...</td>\n","      <td>Para ele, a histÃ³ria de um sujeito criado em u...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>For him, the story of a subject raised in a ve...</td>\n","    </tr>\n","    <tr>\n","      <th>12499</th>\n","      <td>64993</td>\n","      <td>2022-02-22 15:12:26.496000+00:00</td>\n","      <td>https://valor.globo.com/financas/noticia/2022/...</td>\n","      <td>A AgÃªncia Internacional de Energia (IEA, na si...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>The International Energy Agency (IEA) lowers ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>25000 rows Ã 7 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-13ddb8c3-f95c-4cf3-a7ed-6b13ae43165c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-13ddb8c3-f95c-4cf3-a7ed-6b13ae43165c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-13ddb8c3-f95c-4cf3-a7ed-6b13ae43165c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["df_concat = pd.concat([df_nan_cropped, df_val_cropped])\n","df_concat.drop(\"index\", axis=1, inplace=True)\n","df_concat.reset_index(inplace=True)\n","df_concat.drop(\"index\", axis=1, inplace=True)\n","df_concat"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":745},"id":"EvgBWykKQxTF","executionInfo":{"status":"ok","timestamp":1660165165748,"user_tz":180,"elapsed":371,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}},"outputId":"28e0efea-ddf0-4fa6-9cba-6f89ce4df259"},"execution_count":25,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                   date  \\\n","0             2020-11-10 15:20:00+00:00   \n","1             2012-08-03 12:57:11+00:00   \n","2             2012-08-24 22:01:37+00:00   \n","3             2019-07-27 09:00:00+00:00   \n","4             2020-03-30 15:33:00+00:00   \n","...                                 ...   \n","24995         2011-08-11 04:29:50+00:00   \n","24996         2019-08-15 11:55:00+00:00   \n","24997         2021-10-19 12:40:00+00:00   \n","24998         2021-09-01 11:06:00+00:00   \n","24999  2022-02-22 15:12:26.496000+00:00   \n","\n","                                                     url  \\\n","0      https://exame.com/economia/guedes-promete-quat...   \n","1      https://valor.globo.com/eu-e/noticia/2012/08/0...   \n","2      https://valor.globo.com/noticia/2012/08/24/joa...   \n","3      https://exame.com/brasil/o-que-se-sabe-sobre-a...   \n","4      https://exame.com/pme/vamos-salvar-os-empregos...   \n","...                                                  ...   \n","24995  https://valor.globo.com/politica/noticia/2011/...   \n","24996  https://exame.com/revista-exame/33-bilhoes-so-...   \n","24997  https://exame.com/negocios/conheca-o-projeto-d...   \n","24998  https://exame.com/casual/festival-de-veneza-vo...   \n","24999  https://valor.globo.com/financas/noticia/2022/...   \n","\n","                                                   texts  is_title  \\\n","0      Mais cedo, em outro evento, Guedes afirmou se ...     False   \n","1      Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...     False   \n","2      A pesquisa foi realizada entre os dias 20 e 22...     False   \n","3      Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...     False   \n","4      JosÃ© Carlos Semenzato estÃ¡ acostumado com desa...     False   \n","...                                                  ...       ...   \n","24995  \"NÃ£o gastem\", disse Mantega, segundo relato de...     False   \n","24996  Mas, enquanto a soluÃ§Ã£o para aumentar a distri...     False   \n","24997  Em 2019, a iniciativa ganhou o prÃªmio âProjeto...     False   \n","24998  Para ele, a histÃ³ria de um sujeito criado em u...     False   \n","24999  A AgÃªncia Internacional de Energia (IEA, na si...     False   \n","\n","                          theme  \\\n","0      Non-cyclical Consumption   \n","1            Cyclic Consumption   \n","2                Public utility   \n","3      Non-cyclical Consumption   \n","4      Non-cyclical Consumption   \n","...                         ...   \n","24995                Financeiro   \n","24996                Financeiro   \n","24997                Financeiro   \n","24998                Financeiro   \n","24999                Financeiro   \n","\n","                                              translated  \n","0       Earlier, at another event, Guedes said he fel...  \n","1       When talking about Dilma, the look lights up ...  \n","2       The survey was carried out between the 20th a...  \n","3       They are Gustavo Henrique Elias Santos, a for...  \n","4      JosÃ© Carlos Semenzato is used to challenges. T...  \n","...                                                  ...  \n","24995   \"Don't spend it,\" Mantega said, according to ...  \n","24996  But while the solution to increase gas distrib...  \n","24997   In 2019, the initiative won the âInnovative P...  \n","24998  For him, the story of a subject raised in a ve...  \n","24999   The International Energy Agency (IEA) lowers ...  \n","\n","[25000 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-a6bc0060-298f-4a85-a891-17e805290415\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>date</th>\n","      <th>url</th>\n","      <th>texts</th>\n","      <th>is_title</th>\n","      <th>theme</th>\n","      <th>translated</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2020-11-10 15:20:00+00:00</td>\n","      <td>https://exame.com/economia/guedes-promete-quat...</td>\n","      <td>Mais cedo, em outro evento, Guedes afirmou se ...</td>\n","      <td>False</td>\n","      <td>Non-cyclical Consumption</td>\n","      <td>Earlier, at another event, Guedes said he fel...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2012-08-03 12:57:11+00:00</td>\n","      <td>https://valor.globo.com/eu-e/noticia/2012/08/0...</td>\n","      <td>Ao falar de Dilma, o olhar se ilumina - jÃ¡ dec...</td>\n","      <td>False</td>\n","      <td>Cyclic Consumption</td>\n","      <td>When talking about Dilma, the look lights up ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2012-08-24 22:01:37+00:00</td>\n","      <td>https://valor.globo.com/noticia/2012/08/24/joa...</td>\n","      <td>A pesquisa foi realizada entre os dias 20 e 22...</td>\n","      <td>False</td>\n","      <td>Public utility</td>\n","      <td>The survey was carried out between the 20th a...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2019-07-27 09:00:00+00:00</td>\n","      <td>https://exame.com/brasil/o-que-se-sabe-sobre-a...</td>\n","      <td>Eles sÃ£o Gustavo Henrique Elias Santos, um ex-...</td>\n","      <td>False</td>\n","      <td>Non-cyclical Consumption</td>\n","      <td>They are Gustavo Henrique Elias Santos, a for...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2020-03-30 15:33:00+00:00</td>\n","      <td>https://exame.com/pme/vamos-salvar-os-empregos...</td>\n","      <td>JosÃ© Carlos Semenzato estÃ¡ acostumado com desa...</td>\n","      <td>False</td>\n","      <td>Non-cyclical Consumption</td>\n","      <td>JosÃ© Carlos Semenzato is used to challenges. T...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>24995</th>\n","      <td>2011-08-11 04:29:50+00:00</td>\n","      <td>https://valor.globo.com/politica/noticia/2011/...</td>\n","      <td>\"NÃ£o gastem\", disse Mantega, segundo relato de...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>\"Don't spend it,\" Mantega said, according to ...</td>\n","    </tr>\n","    <tr>\n","      <th>24996</th>\n","      <td>2019-08-15 11:55:00+00:00</td>\n","      <td>https://exame.com/revista-exame/33-bilhoes-so-...</td>\n","      <td>Mas, enquanto a soluÃ§Ã£o para aumentar a distri...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>But while the solution to increase gas distrib...</td>\n","    </tr>\n","    <tr>\n","      <th>24997</th>\n","      <td>2021-10-19 12:40:00+00:00</td>\n","      <td>https://exame.com/negocios/conheca-o-projeto-d...</td>\n","      <td>Em 2019, a iniciativa ganhou o prÃªmio âProjeto...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>In 2019, the initiative won the âInnovative P...</td>\n","    </tr>\n","    <tr>\n","      <th>24998</th>\n","      <td>2021-09-01 11:06:00+00:00</td>\n","      <td>https://exame.com/casual/festival-de-veneza-vo...</td>\n","      <td>Para ele, a histÃ³ria de um sujeito criado em u...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>For him, the story of a subject raised in a ve...</td>\n","    </tr>\n","    <tr>\n","      <th>24999</th>\n","      <td>2022-02-22 15:12:26.496000+00:00</td>\n","      <td>https://valor.globo.com/financas/noticia/2022/...</td>\n","      <td>A AgÃªncia Internacional de Energia (IEA, na si...</td>\n","      <td>False</td>\n","      <td>Financeiro</td>\n","      <td>The International Energy Agency (IEA) lowers ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>25000 rows Ã 6 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a6bc0060-298f-4a85-a891-17e805290415')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a6bc0060-298f-4a85-a891-17e805290415 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a6bc0060-298f-4a85-a891-17e805290415');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":25}]},{"cell_type":"code","source":["df_concat.to_excel(\"concat_df.xlsx\", index=False)"],"metadata":{"id":"SFJPUEgXjJ8C","executionInfo":{"status":"ok","timestamp":1660165175569,"user_tz":180,"elapsed":5078,"user":{"displayName":"Enzo Bustos da Silva","userId":"00423683093258305256"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":[""],"metadata":{"id":"dfjpQT0ijM40"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Rotulagem em Setores","provenance":[],"mount_file_id":"11qR8RIMscIWRBeM-9ke1gcnwj0pUlnRm","authorship_tag":"ABX9TyPOYSZOI3DAuwh8d9H2iLjW"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"1705debae38e47ee94d771b89e9aa724":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a88b631e1dff4db49f18d47ec3da5717","IPY_MODEL_352c1a72fb4947c9914340eb2b7d4bd7","IPY_MODEL_0f40f96cd705469096da2bdae43615a2"],"layout":"IPY_MODEL_5c279bc190e3448398311a7c946b6577"}},"a88b631e1dff4db49f18d47ec3da5717":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f875dc84d1f4a8b8be334d108844ba2","placeholder":"â","style":"IPY_MODEL_87eb226e3237459e8d8b4c48260018aa","value":"100%"}},"352c1a72fb4947c9914340eb2b7d4bd7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6b4ef45b2d6a4b7d85f71ed4884d0a4d","max":12500,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cbe2f1b600554e1e8638b9afc951a32f","value":12500}},"0f40f96cd705469096da2bdae43615a2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2ef3c343d7694b41b22ccb422e901ecf","placeholder":"â","style":"IPY_MODEL_f85563e2197e49328d6aa1161410721f","value":" 12500/12500 [57:06&lt;00:00,  3.23it/s]"}},"5c279bc190e3448398311a7c946b6577":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6f875dc84d1f4a8b8be334d108844ba2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"87eb226e3237459e8d8b4c48260018aa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6b4ef45b2d6a4b7d85f71ed4884d0a4d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cbe2f1b600554e1e8638b9afc951a32f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2ef3c343d7694b41b22ccb422e901ecf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f85563e2197e49328d6aa1161410721f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"accelerator":"GPU","gpuClass":"standard"},"nbformat":4,"nbformat_minor":0}